# ratinglist
A REST API for calculating and displaying Mahjong rating

## VirtualEnv
`source bin/activate` to switch to virtual environment

`deactivate` to switch back to default

## Heroku
This app is currently hosted on Heroku (http://ratinglist.herokuapp.com)

This requires that the `requirements.txt` file be kept up to date with the `pip` packages that the app uses.

The file can be automatically generated by `pip freeze > requirements.txt`

To publish changes: `git push heroku`

To run migrations on Heroku: `heroku run python manage.py migrate`

## Postgres

The 'citext' extension must be enabled (case-insensitive text column type)

Locally:
```
\c database_name
CREATE EXTENSION citext;
\q
```

Heroku:
```
heroku pg:psql
CREATE EXTENSION citext;
\q
```

Herokup backups:
https://devcenter.heroku.com/articles/heroku-postgres-backups
```
heroku pg:backups capture --app ratinglist && heroku pg:backups public-url --app ratinglist | xargs wget -O 'test-backup'
``
## Local Debugging

For local debugging, postgres must be running: `postgres -D /usr/local/var/postgres/`

Start the server with `python manage.py runserver`. Defaults to http://localhost:8000

## Testing

This app uses behave and BDD style tests. Run with `behave` from the application root

## Template

Uses the Heroku Django Starter Template (https://github.com/heroku/heroku-django-template), which includes:

- [Gunicorn](https://warehouse.python.org/project/gunicorn/)
- [WhiteNoise](https://warehouse.python.org/project/whitenoise/)
- [django-postgrespool](https://warehouse.python.org/project/django-postgrespool/)
- [dj-database-url](https://warehouse.python.org/project/dj-database-url/)
